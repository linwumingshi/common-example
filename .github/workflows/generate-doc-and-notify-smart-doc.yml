name: Run Plugin

on:
  repository_dispatch:
    types: [run-plugin]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Download and Extract Artifact
        run: |
          ARTIFACT_URL="${{ github.event.client_payload.artifact_url }}"
          curl -L -o smart-doc-source.zip "$ARTIFACT_URL"
          unzip smart-doc-source.zip -d ~/.m2/repository/com/github/linwumingshi

      - name: Set up JDK 11
        uses: actions/setup-java@v4
        with:
          java-version: '11'
          distribution: 'temurin'

      - name: Use Plugin
        run: |
          mvn install:install-file -Dfile=~/.m2/repository/com/github/linwumingshi/smart-doc-source/your-plugin.jar -DgroupId=com.github.linwumingshi -DartifactId=your-plugin -Dversion=1.0.0 -Dpackaging=jar
